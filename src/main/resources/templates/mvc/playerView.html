<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<!-- Required meta tags always come first -->
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta th:if="${playerView.playerColor != playerView.colorOfCurrentTurnPlayer}" http-equiv="Refresh" content="5">
 <!-- Bootstrap CSS -->
 	<meta http-equiv="x-ua-compatible" content="ie=edge">
 	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">	
<!--   <link th:href="@{/styles/cssandjs/main.css}" rel="stylesheet" />
 -->  	<title>Pegs and Jokers</title>
	<script type="text/javascript" th:src="@{/js/cssandjs/actions.js}"></script>
	<script th:inline="javascript">
   		 var nameJs = /*[[${playerView.playerColor}]]*/;
	</script>
	<style>
	.row.equal-cols {
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  flex-wrap: wrap;
}

.row.equal-cols:before,
.row.equal-cols:after {
  display: block;
}

.row.equal-cols > [class*='col-'] {
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
}

.row.equal-cols > [class*='col-'] > * {
  -webkit-flex: 1 1 auto;
  -ms-flex: 1 1 auto;
  flex: 1 1 auto; 
}
	</style>
</head>
<body>
	<div class="container-fluid">
	 <div class="row">
		<div class = "col" id="message">
			You are the <span th:text="${playerView.playerColor}">player
				color</span> player. <span th:text="${playerView.playerMessage}">player
				message</span><br/>
		</div>
	</div>
	<div class="row equal-cols">
		<div class="col-xs" id="board">
			<h3>Current Board</h3>
			<table class="table table-bordered table-sm">
				<thead>
 				<tr>
					<th scope="col">Burnt Cards</th>
					<th scope="col">Current<br/>Player</th>
					<th scope="col">Side Color</th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col">Go Home</th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col">Come Out</th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
					<th scope="col"></th>
				</tr>
				<thead>
				<tbody>
				<th:block th:each="side, iterStat : ${playerView.board.playerSides}">
					<tr>
	 					<td rowspan="3">
						<span th:if="${playerView.burntCardCounts[iterStat.index] > 0}">
							<th:block th:each="i: ${#numbers.sequence(1, playerView.burntCardCounts[iterStat.index])}">
								<img th:src="@{'/cards/Card_back_resized.svg'}" alt="face-down card" class="img-fluid" height="80" width="60"/>
							</th:block>
						</span>
						</td>
 						<td rowspan="3"><span th:if="${side.color == playerView.colorOfCurrentTurnPlayer}"><img th:src="@{/images/ltr-grey.svg}" alt="Current Player" class="img-fluid"/></span> </td>
						<td th:bgcolor="${side.color}" th:text="'Start'" >color<br />Home
							Track
						</td>
						<td style="border: none"></td>
						<td style="border: none"></td>
						<td style="border: none"></td>
						<td align="center"  th:each="hp : ${side.startPositions}"
							th:bgcolor="${hp.pegColor}"><span th:if="${hp.pegNumber!=null}" th:text="${hp.pegNumber}">peg
								color</span><span th:if="${hp.pegNumber==null}" th:text="${'&#x2022'}">bullet</span></td>
					</tr>
					<tr>
		 				<td th:bgcolor="${side.color}" th:text="${side.color}">color</td>
						<td align="center" th:each="mp : ${side.mainTrackPositions}"
							th:bgcolor="${mp.pegColor}"><span th:if="${mp.pegNumber!=null}" th:text="${mp.pegNumber}">peg
								color</span><span th:if="${mp.pegNumber==null}" th:text="${'&#x2022'}">bullet</span>
						</td>
					</tr>
					<tr>
						<td th:bgcolor="${side.color}" th:text="'Home'">color<br />Home
							Track
						</td>
						<td style="border: none"></td>
						<td style="border: none"></td>
						<td align="center"  th:each="hp : ${side.homePositions}"
							th:bgcolor="${hp.pegColor}"><span th:if="${hp.pegNumber!=null}" th:text="${hp.pegNumber}">peg
								color</span><span th:if="${hp.pegNumber==null}" th:text="${'&#x2022'}">bullet</span></td>
					</tr>
				</th:block>
				</tbody>
			</table>
		</div> <!-- end of playerView left hand side board layout column div -->
		<div class="col-4">
		<div class="container-fluid">
		<div class="row">
		<div class="col" id="drawPile">
			<table class="table table-sm">
			<thead>
			<tr>
			<th scope="col">Draw Pile</th>
			<th scope="col">Discard Pile</th>
			</tr>
			</thead>
			<tbody>
			<tr>
			<td><figure><img th:src="@{/cards/Card_back_resized.svg}" alt="Discard Pile" class="img-fluid" ><figcaption><span th:text="${playerView.cardsRemaining}">cards remaining</span> cards remaining </figcaption></figure></td> 
	 		<td><figure th:if="${playerView.lastCardPlayed}"><img th:src="@{'/cards/Playing_card_'+${playerView.lastCardPlayed.name}+'.svg'}" alt="Last Card Played" class="img-fluid"><figcaption>Last Card Played</figcaption></figure></td> 
	 		</tr>
			</tbody>
			</table>
		</div>  <!-- end of discard and draw pile col div -->
		<div class="col-6"></div>
		</div>  <!-- end of discard and draw pile row div -->
	<div class="row">
		<div class="col" id="playerHand">
			<h3>Player Hand</h3>

			<table class="table table-sm">
			<tbody>
			<tr>
			<th:block th:each="card : ${playerView.playerHand.cards}">
				<td>   
				<img th:src="@{'/cards/Playing_card_'+${card.name}+'.svg'}"
				    th:data-cardname="${card.name}"
					alt="${card.name}" class="img-fluid" 
					/>
				</td> 
			</th:block>
<!-- 				<th:block th:if="${playerView.playerHand.burnedCardCount > 0}" th:each="i: ${#numbers.sequence(1, playerView.playerHand.burnedCardCount)}">
					<td>  
					<img th:src="@{'/cards/Card_back_resized.svg'}" alt="face-down card" class="img-fluid" />
			 		</td>
				</th:block>
	 -->	</tr>
			</tbody>
			</table>
		</div> <!-- end of playerhand col div -->
	</div> <!-- end of playerhand row div -->
	</div> <!-- end of player view right hand side with cards nested container div -->
	</div> <!-- end of player view right hand side with cards col div -->
	</div> <!-- end of player view row div -->
<!--   form section for taking turns -->
 	<div class="row">
 	  <div class="col">
 		<p th:if="${playerView.playerColor != playerView.colorOfCurrentTurnPlayer}">
 			<button class="btn btn-primary"  type="button" th:onclick="refreshPage()">Refresh</button>
		</p>
		<h3 th:if="${playerView.playerColor == playerView.colorOfCurrentTurnPlayer}">Take a turn</h3>

		<form th:if="${playerView.playerColor == playerView.colorOfCurrentTurnPlayer}" action="#" th:action="@{/mvc/taketurn}"
			th:object="${turnRequest}" method="post">
			<input type="hidden" th:field="*{playerNumber}" /> <input
				type="hidden" th:field="*{gameId}" />
			<!--        <p>Card Name: <input type="text" th:field="*{cardName}" />  -->
			<label for="cardName">Which card do you want to play? </label><select
				th:field="*{cardName}">
				<option th:each="card : ${playerView.playerHand.cards}"
					th:value="${card.name}" th:text="${card.name}">card name
					here</option>
			</select><p /> <label for="moveType">Which type of move do you want
				to make? </label> <select th:field="*{moveType}">
				<option th:value="START_A_PEG" th:text="'Start a peg'">second</option>
				<option th:value="MOVE_PEG" th:text="'Move a peg'">second</option>
				<option th:value="SPLIT_MOVE" th:text="'Split move'">second</option>
				<option th:value="USE_JOKER" th:text="'Use a joker'">second</option>
				<option th:value="DISCARD" th:text="'Burn a Card'">discard</option>
				<option th:disabled="${playerView.playerHand.burnedCardCount != 2}" th:value="FREE_START" th:text="'Free Start'">free start</option>
			</select>
			<!-- 	    <input type="radio" th:field="*{moveType}" th:value="DISCARD" />
		<label for="moveType1">Discard</label><br>
 	    <input type="radio" th:field="*{moveType}" th:value="START_A_PEG" />
		<label for="moveType2">Start a Peg</label><br>
 	    <input type="radio" th:field="*{moveType}" th:value="MOVE_PEG" />
		<label for="moveType3">Move Peg</label><br>
 	    <input type="radio" th:field="*{moveType}" th:value="SPLIT_MOVE" />
		<label for="moveType4">Split Move Between Two Pegs</label><br>
		<input type="radio" th:field="*{moveType}" th:value="USE_JOKER" />
		<label for="moveType5	">Use A Joker</label><br>
-->
			<p />
			<label
				th:text="'Which '+ ${playerView.playerColor} + ' peg do you want to move?'">which
				peg</label> <select th:field="*{playerPositionNumber}">
				<option th:each="i : ${#numbers.sequence(1, 5)}" th:value="${i}"
					th:text="${i}"></option>
			</select>
			<!--        <p><label>How many spaces do you want to move? </label><input type="number" min="-8" max="13" th:field="*{moveDistance}" /> </p> spaces.  (not needed for starting, discarding, or jokers)  -->
			<p />
			<label>How many spaces do you want to move? </label> <select
				th:field="*{moveDistance}">
				<option th:each="i : ${#numbers.sequence(-8, 13)}" th:value="${i}"
					th:text="${i}"></option>
			</select> spaces. (not needed for starting, discarding, or jokers)
			Jacks=11,Queens=12,Kings=13
			<p>
				----FOR SPLIT MOVES ONLY---<br />(7s MAY split (both forward), 9s
				MUST split (one forward, one back) )-
			</p>
			<label
				th:text="'If this is a split move, pick another '+${playerView.playerColor}+' peg: '">second
				peg</label> <select th:field="*{playerPositionNumber2}">
				<option th:each="i : ${#numbers.sequence(1, 5)}" th:value="${i}"
					th:text="${i}"></option>
			</select> <p />
			<label>How far do you want to move the second peg? </label> <select
				th:field="*{moveDistance2}">
				<option th:each="i : ${#numbers.sequence(-8, 13)}" th:value="${i}"
					th:text="${i}"></option>
			</select> spaces.
			<p>----FOR JOKER MOVES ONLY----</p>
			<label>For Jokers, pick an opponent's peg to send back to
				start: </label> <select th:field="*{targetBoardPosition}">
			<th:block th:each="player:${playerView.otherPlayerPositions}">
					<option th:each="position : ${player}"
						th:value="${position.playerBoardPositionId}"
						th:text="${position.pegColor}+ ' peg# ' + ${position.pegNumber} ">board
						position id</option>
				</th:block>

			</select>

			<br />
			<input class="btn btn-primary" type="submit" value="Submit" />
		</form>
	  </div> <!-- end of form col div -->
	</div>  <!-- end of form row div -->
<!--  		<button type="button" th:onclick="showAlert()">Show Alert</button>
		<button type="button" th:onclick="showName(nameJs);">Show Name</button> -->
</div> <!--  end of body container div -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
</body>
</html>